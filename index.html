<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>LG Subscribe Malaysia | Digital Partner Hub</title>
  
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { 
            'lg-red': '#e60044', 
            'lg-dark': '#05090f', 
            'lg-pearl': '#f8f9fa'
          },
          fontFamily: { sans: ['Outfit', 'sans-serif'] }
        }
      }
    }
  </script>

  <style type="text/tailwindcss">
    @tailwind base;
    @tailwind components;
    @tailwind utilities;

    @layer base {
      body { @apply bg-white text-lg-dark font-sans antialiased m-0 p-0 overflow-x-hidden; }
    }
    .premium-blur { @apply backdrop-blur-2xl bg-white/80 border border-white/20; }
    .shadow-premium { box-shadow: 0 30px 60px rgba(0,0,0,0.06); }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-up { animation: fadeUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    
    input, select, textarea { @apply bg-gray-50 border border-gray-100 rounded-2xl p-4 outline-none focus:border-lg-red transition-all font-medium; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
  </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "lucide-react": "https://esm.sh/lucide-react@^0.563.0",
    "react/": "https://esm.sh/react@^19.2.4/",
    "@google/genai": "https://esm.sh/@google/genai@^1.39.0",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const Icon = ({ name, size = 20, className = "" }) => {
      useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]);
      return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
    };

    // --- 字典数据 ---
    const DICT = {
      cn: {
        heroSub: "LG Subscribe 马来西亚认证合作伙伴。以极简的月付方案，解锁全球顶尖家电艺术。",
        explore: "立即浏览展厅",
        partnerNote: "专属认证顾问",
        contactNow: "立即咨询",
        monthly: "月付低至",
        showroom: "数字化展厅",
        joinUs: "加入我们的合作伙伴计划",
        earnComm: "赚取高达 13% 佣金",
        adminTitle: "后台管理",
        inventory: "库存管理",
        siteConfig: "站点配置",
        affiliates: "代理分销",
        promo: "促销模板",
        backup: "数据备份",
        perMo: "/月"
      },
      en: {
        heroSub: "LG Subscribe Malaysia Certified Partner. Experience premium living with flexible subscription plans.",
        explore: "Explore Showroom",
        partnerNote: "Certified Consultant",
        contactNow: "Contact Now",
        monthly: "Monthly From",
        showroom: "Digital Showroom",
        joinUs: "Join Our Partner Program",
        earnComm: "Earn up to 13% Commission",
        adminTitle: "Admin Console",
        inventory: "Inventory",
        siteConfig: "Site Settings",
        affiliates: "Affiliates",
        promo: "Promotions",
        backup: "Backup",
        perMo: "/Mo"
      },
      ms: {
        heroSub: "Rakan Kongsi Sah LG Subscribe Malaysia. Alami kehidupan premium dengan pelan langganan fleksibel.",
        explore: "Teroka Koleksi",
        partnerNote: "Perunding Sah",
        contactNow: "Hubungi Sekarang",
        monthly: "Bulanan Dari",
        showroom: "Bilik Pameran Digital",
        joinUs: "Sertai Program Rakan Kami",
        earnComm: "Komisyen sehingga 13%",
        adminTitle: "Konsol Admin",
        inventory: "Inventori",
        siteConfig: "Konfigurasi",
        affiliates: "Ejen/Afiliasi",
        promo: "Promosi",
        backup: "Sandaran",
        perMo: "/Bulan"
      }
    };

    // --- 初始数据 ---
    const INITIAL_PRODUCTS = [
      { id: 'WP-PURI-V', category: 'Water Purifier', name: 'PuriCare™ Tankless', subName: { cn: '无水箱净水机', en: 'Tankless Self-Service', ms: 'Penapis Air Tanpa Tangki' }, image: 'https://www.lg.com/content/dam/channel/wcms/my/images/water-purifiers/wd516an_answ_e_my_c/gallery/dz-01.jpg', price: 60, isHot: true },
      { id: 'AC-V13ENS', category: 'Air Conditioner', name: 'DUALCOOL™ Inverter', subName: { cn: '双变频冷气机', en: 'Dual Inverter AC', ms: 'Penyaman Udara Inverter' }, image: 'https://www.lg.com/content/dam/channel/wcms/my/images/air-conditioners/v10api_answ_e_my_c/gallery/dz-01.jpg', price: 45, isHot: true },
      { id: 'REF-SIDE', category: 'Refrigerator', name: 'Side-by-Side Inverter', subName: { cn: '对开门变频冰箱', en: 'Large Capacity Fridge', ms: 'Peti Sejuk Kapasiti Besar' }, image: 'https://www.lg.com/content/dam/channel/wcms/my/images/refrigerators/gr-b247sluv_asbp_e_my_c/gallery/dz-01.jpg', price: 150, isHot: false }
    ];

    const INITIAL_SETTINGS = {
      logo: 'https://i.ibb.co/Rk6m7Yw/lg-sub-logo-red.png',
      heroImage: 'https://www.lg.com/content/dam/channel/wcms/my/images/air-conditioners/v10api_answ_e_my_c/gallery/dz-01.jpg',
      heroTitle: { cn: '科技定义 优雅生活', en: 'ELEGANCE IN TECH', ms: 'KEANGGUNAN TEKNOLOGI' },
      contactPhone: '60177473787',
      adminPin: '8888'
    };

    // 数据迁移工具：确保旧格式（字符串）转换为新格式（多语言对象）
    const migrateMultilingual = (data, defaultValue = "") => {
      if (typeof data === 'string') return { cn: data, en: data, ms: data };
      if (data && typeof data === 'object' && (data.cn || data.en || data.ms)) return data;
      return { cn: defaultValue, en: defaultValue, ms: defaultValue };
    };

    const App = () => {
      const [view, setView] = useState('home');
      const [lang, setLang] = useState('cn');
      const [isAdmin, setIsAdmin] = useState(false);
      const [activeTab, setActiveTab] = useState('inventory');
      
      const loadData = (key, initial) => {
        const saved = localStorage.getItem(key);
        if (!saved) return initial;
        try { return JSON.parse(saved); } catch (e) { return initial; }
      };

      const [products, setProducts] = useState(() => {
        let items = loadData('lg_products_v7', INITIAL_PRODUCTS);
        return items.map(p => ({ ...p, subName: migrateMultilingual(p.subName) }));
      });
      const [settings, setSettings] = useState(() => {
        let s = loadData('lg_settings_v7', INITIAL_SETTINGS);
        return { ...s, heroTitle: migrateMultilingual(s.heroTitle) };
      });
      const [agents, setAgents] = useState(() => loadData('lg_affiliates_v7', []));
      const [templates, setTemplates] = useState(() => loadData('lg_templates_v7', []));
      
      const [activeAgent, setActiveAgent] = useState(null);
      const [editingProduct, setEditingProduct] = useState(null);
      const [copiedId, setCopiedId] = useState(null);

      useEffect(() => {
        localStorage.setItem('lg_products_v7', JSON.stringify(products));
        localStorage.setItem('lg_settings_v7', JSON.stringify(settings));
        localStorage.setItem('lg_affiliates_v7', JSON.stringify(agents));
        localStorage.setItem('lg_templates_v7', JSON.stringify(templates));
      }, [products, settings, agents, templates]);

      useEffect(() => {
        const params = new URLSearchParams(window.location.search);
        const wa = params.get('wa');
        const name = params.get('name');
        if (wa) {
          const current = { name: name || 'Authorized Partner', wa: wa.replace(/\D/g, '') };
          setActiveAgent(current);
          localStorage.setItem('cached_agent_v7', JSON.stringify(current));
        } else {
          const saved = localStorage.getItem('cached_agent_v7');
          if (saved) setActiveAgent(JSON.parse(saved));
        }
      }, []);

      const t = DICT[lang];

      const handleBackup = () => {
        const data = { products, settings, agents, templates, version: 'v7' };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `lg_backup_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
      };

      const handleRestore = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (event) => {
          try {
            const data = JSON.parse(event.target.result);
            
            // 数据迁移适配逻辑
            if (data.products) {
              const migratedProducts = data.products.map(p => ({
                ...p,
                subName: migrateMultilingual(p.subName)
              }));
              setProducts(migratedProducts);
            }
            
            if (data.settings) {
              const migratedSettings = {
                ...data.settings,
                heroTitle: migrateMultilingual(data.settings.heroTitle)
              };
              setSettings(migratedSettings);
            }
            
            if (data.agents) setAgents(data.agents);
            if (data.templates) setTemplates(data.templates);
            
            alert("数据还原成功！部分旧版数据已自动适配多语言格式。");
          } catch (err) { 
            console.error(err);
            alert("读取备份文件失败，请确保文件格式正确。"); 
          }
        };
        reader.readAsText(file);
        // 清空 input 确保下次选择同一文件也能触发
        e.target.value = '';
      };

      return (
        <div className="min-h-screen bg-white">
          {/* Navigation */}
          <nav className="fixed top-0 w-full z-50 h-20 premium-blur flex items-center px-6 justify-between border-b border-gray-100">
            <button onClick={() => setView('home')}>
              <img src={settings.logo} className="h-6" alt="LG" />
            </button>
            <div className="flex items-center gap-3">
              {['cn', 'en', 'ms'].map(l => (
                <button 
                  key={l} 
                  onClick={() => setLang(l)} 
                  className={`px-3 py-1.5 rounded-full text-[9px] font-black uppercase transition-all ${lang === l ? 'bg-lg-red text-white shadow-lg' : 'bg-gray-100 text-gray-400 hover:text-gray-950'}`}
                >
                  {l}
                </button>
              ))}
            </div>
          </nav>

          {view === 'home' ? (
            <div className="pt-20">
              {/* Hero Section */}
              <section className="bg-lg-pearl py-20 px-6 flex flex-col items-center text-center">
                <div className="max-w-4xl mx-auto space-y-8 animate-fade-up">
                  <span className="inline-flex items-center gap-2 px-4 py-2 bg-white rounded-full shadow-sm text-[10px] font-black text-gray-400 uppercase tracking-widest border border-gray-100">
                    <Icon name="shield-check" size={14} className="text-lg-red" /> Certified Partner
                  </span>
                  <h1 className="text-5xl md:text-8xl font-black uppercase tracking-tighter leading-none">
                    {settings.heroTitle[lang] || settings.heroTitle.cn}
                  </h1>
                  <p className="text-gray-400 font-medium text-lg max-w-2xl mx-auto">{t.heroSub}</p>
                  <button onClick={() => document.getElementById('catalog').scrollIntoView({behavior:'smooth'})} className="bg-lg-red text-white px-12 py-6 rounded-full font-black uppercase text-[11px] tracking-widest shadow-2xl hover:bg-lg-dark transition-all">
                    {t.explore}
                  </button>
                </div>
                <img src={settings.heroImage} className="max-w-4xl w-full h-auto mt-16 drop-shadow-2xl animate-fade-up" />
              </section>

              {/* Agent Floating Badge */}
              {activeAgent && (
                <div className="sticky top-24 z-40 flex justify-center px-6 -mt-10 pointer-events-none">
                  <div className="premium-blur shadow-premium rounded-full px-8 py-4 flex items-center gap-8 pointer-events-auto animate-fade-up">
                    <div className="flex items-center gap-4 border-r pr-8 border-gray-100">
                      <div className="w-10 h-10 bg-lg-red rounded-full flex items-center justify-center text-white shadow-lg"><Icon name="star" size={20} /></div>
                      <div className="text-left">
                        <span className="text-[9px] font-black text-gray-400 uppercase tracking-widest block leading-none">{t.partnerNote}</span>
                        <span className="text-sm font-black uppercase text-gray-950 mt-1">{activeAgent.name}</span>
                      </div>
                    </div>
                    <a href={`https://wa.me/${activeAgent.wa}?text=Hi, I am interested in LG Subscribe from your showroom.`} target="_blank" className="text-[10px] font-black text-lg-red uppercase tracking-widest flex items-center gap-2">
                      {t.contactNow} <Icon name="arrow-right" size={14} />
                    </a>
                  </div>
                </div>
              )}

              {/* Catalog */}
              <section id="catalog" className="py-24 max-w-7xl mx-auto px-6 grid md:grid-cols-3 gap-12">
                {products.map(p => (
                  <div key={p.id} className="bg-white rounded-[45px] p-10 border border-gray-100 flex flex-col group hover:shadow-premium transition-all duration-700 animate-fade-up">
                    <div className="flex justify-between mb-8">
                      <span className="text-[10px] font-black text-gray-300 uppercase tracking-widest">{p.category}</span>
                      {p.isHot && <span className="bg-lg-red text-white text-[9px] font-black px-3 py-1.5 rounded-full uppercase">Hot</span>}
                    </div>
                    <div className="aspect-square mb-10 flex items-center justify-center relative">
                      <div className="absolute inset-0 bg-lg-pearl rounded-full scale-90 group-hover:scale-100 transition-transform"></div>
                      <img src={p.image} className="max-h-[85%] object-contain relative z-10 group-hover:scale-110 transition-transform duration-700" alt={p.name} />
                    </div>
                    <h3 className="text-2xl font-black uppercase mb-1">{p.name}</h3>
                    <p className="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-10">{p.subName[lang] || p.subName.cn}</p>
                    <div className="mt-auto pt-8 border-t border-gray-50 flex items-end justify-between">
                      <div>
                        <span className="text-lg-red text-[10px] font-black uppercase tracking-widest block mb-1">{t.monthly}</span>
                        <span className="text-4xl font-black text-gray-950 tracking-tighter">RM{p.price}</span>
                        <span className="text-[10px] font-black text-gray-300 ml-1">{t.perMo}</span>
                      </div>
                      <a href={`https://wa.me/${activeAgent?.wa || settings.contactPhone}?text=Hi, I want to inquire about ${p.name}`} target="_blank" className="bg-gray-950 text-white p-5 rounded-full hover:bg-lg-red transition-all shadow-xl">
                        <Icon name="arrow-right" size={24} />
                      </a>
                    </div>
                  </div>
                ))}
              </section>

              {/* Footer Recruitment */}
              <footer className="bg-lg-dark text-white py-32 px-6 text-center space-y-12">
                 <h2 className="text-4xl md:text-6xl font-black uppercase tracking-tighter max-w-3xl mx-auto leading-none">
                   {t.joinUs} <br/><span className="text-lg-red">{t.earnComm}</span>
                 </h2>
                 <div className="flex flex-wrap justify-center gap-10 opacity-30 text-[10px] font-bold uppercase tracking-widest">
                   <span>Zero Inventory</span>
                   <span>Nationwide Support</span>
                   <span>Official Service</span>
                 </div>
                 <a href={`https://wa.me/${settings.contactPhone}?text=I want to join the LG partner program.`} target="_blank" className="bg-white text-lg-dark px-16 py-6 rounded-full font-black uppercase text-[11px] tracking-widest shadow-2xl hover:bg-lg-red hover:text-white transition-all">
                   Become a Partner
                 </a>
                 <div className="pt-20 opacity-20 text-[9px] font-black uppercase tracking-[0.5em] flex justify-center items-center gap-2">
                   <button onClick={() => { 
                     const pin = prompt("Admin PIN:"); 
                     if(pin === settings.adminPin) { setView('admin'); setIsAdmin(true); } 
                     else if(pin !== null) alert("PIN 错误");
                   }} className="hover:text-white transition-colors">©</button> 2025 LG Subscribe Malaysia Hub
                 </div>
              </footer>
            </div>
          ) : (
            /* Admin Console */
            <div className="pt-32 px-6 max-w-6xl mx-auto min-h-screen pb-32">
               <div className="space-y-12 animate-fade-up">
                  <div className="flex flex-wrap gap-4 border-b border-gray-100 pb-8 items-center">
                    <h1 className="text-xl font-black uppercase tracking-tighter mr-8">{t.adminTitle}</h1>
                    {['inventory', 'settings', 'agents', 'templates', 'backup'].map(tab => (
                      <button key={tab} onClick={() => setActiveTab(tab)} className={`px-6 py-2.5 rounded-full text-[9px] font-black uppercase tracking-widest transition-all ${activeTab === tab ? 'bg-lg-red text-white shadow-lg' : 'bg-gray-50 text-gray-400 hover:text-lg-dark'}`}>
                        {t[tab]}
                      </button>
                    ))}
                    <button onClick={() => { setView('home'); setIsAdmin(false); }} className="ml-auto text-[9px] font-black uppercase text-gray-300 hover:text-lg-red">Exit</button>
                  </div>

                  {activeTab === 'inventory' && (
                    <div className="grid md:grid-cols-3 gap-8">
                       {products.map(p => (
                         <div key={p.id} className="bg-white p-6 rounded-[40px] border border-gray-100 flex items-center gap-6 group hover:border-lg-red transition-all">
                            <img src={p.image} className="w-16 h-16 object-contain bg-gray-50 rounded-2xl" />
                            <div className="flex-grow">
                               <p className="font-black uppercase text-sm">{p.name}</p>
                               <p className="text-[10px] font-bold text-gray-400">RM{p.price}</p>
                            </div>
                            <button onClick={() => setEditingProduct({...p})} className="p-3 bg-gray-50 rounded-full hover:bg-lg-red hover:text-white transition-all"><Icon name="edit-3" size={16}/></button>
                         </div>
                       ))}
                       <button onClick={() => {
                         const nP = { id: Date.now(), category: 'NEW', name: 'New Product', subName: { cn: '', en: '', ms: '' }, image: '', price: 99, isHot: false };
                         setProducts([...products, nP]);
                         setEditingProduct(nP);
                       }} className="border-4 border-dashed border-gray-100 rounded-[40px] flex items-center justify-center text-gray-300 hover:text-lg-red hover:border-lg-red transition-all aspect-[3/1]">
                         <Icon name="plus" size={24} />
                       </button>
                    </div>
                  )}

                  {activeTab === 'settings' && (
                    <div className="bg-gray-50 p-12 rounded-[50px] grid md:grid-cols-2 gap-8">
                       <div className="space-y-4">
                         <label className="text-[9px] font-black uppercase text-gray-400 tracking-widest ml-4">Logo URL</label>
                         <input value={settings.logo} onChange={e => setSettings({...settings, logo: e.target.value})} className="w-full" />
                       </div>
                       <div className="space-y-4">
                         <label className="text-[9px] font-black uppercase text-gray-400 tracking-widest ml-4">Master WhatsApp</label>
                         <input value={settings.contactPhone} onChange={e => setSettings({...settings, contactPhone: e.target.value})} className="w-full" />
                       </div>
                       <div className="space-y-4">
                         <label className="text-[9px] font-black uppercase text-gray-400 tracking-widest ml-4">Hero Image URL</label>
                         <input value={settings.heroImage} onChange={e => setSettings({...settings, heroImage: e.target.value})} className="w-full" />
                       </div>
                       <div className="space-y-4">
                         <label className="text-[9px] font-black uppercase text-gray-400 tracking-widest ml-4">Admin PIN</label>
                         <input value={settings.adminPin} onChange={e => setSettings({...settings, adminPin: e.target.value})} className="w-full" />
                       </div>
                       {['cn', 'en', 'ms'].map(l => (
                         <div key={l} className="space-y-4">
                           <label className="text-[9px] font-black uppercase text-gray-400 tracking-widest ml-4">Hero Title ({l.toUpperCase()})</label>
                           <input value={settings.heroTitle[l]} onChange={e => {
                             const newTitles = {...settings.heroTitle, [l]: e.target.value};
                             setSettings({...settings, heroTitle: newTitles});
                           }} className="w-full" />
                         </div>
                       ))}
                    </div>
                  )}

                  {activeTab === 'agents' && (
                    <div className="space-y-8">
                       <div className="bg-lg-dark p-10 rounded-[45px] grid md:grid-cols-3 gap-6">
                         <input id="aname" placeholder="Agent Name" className="bg-white/5 border-white/10 text-white" />
                         <input id="awa" placeholder="WhatsApp (601...)" className="bg-white/5 border-white/10 text-white" />
                         <button onClick={() => {
                           const n = document.getElementById('aname').value;
                           const w = document.getElementById('awa').value.replace(/\D/g, '');
                           if(!n || !w) return;
                           setAgents([...agents, { name: n, wa: w }]);
                           document.getElementById('aname').value = '';
                           document.getElementById('awa').value = '';
                         }} className="bg-lg-red text-white font-black uppercase text-[10px] tracking-widest rounded-3xl hover:bg-white hover:text-lg-red transition-all">Add Agent</button>
                       </div>
                       <div className="grid gap-4">
                         {agents.map(a => (
                           <div key={a.wa} className="bg-white p-6 rounded-[30px] border border-gray-100 flex justify-between items-center shadow-sm">
                             <div><p className="font-black uppercase">{a.name}</p><p className="text-[9px] text-gray-300 font-bold uppercase mt-1 tracking-widest">WA: {a.wa}</p></div>
                             <div className="flex gap-2">
                               <button onClick={() => {
                                 const baseUrl = window.location.href.split('?')[0];
                                 const link = `${baseUrl}?wa=${a.wa}&name=${encodeURIComponent(a.name)}`;
                                 navigator.clipboard.writeText(link);
                                 setCopiedId(a.wa);
                                 setTimeout(() => setCopiedId(null), 2000);
                               }} className={`px-6 py-3 rounded-full text-[9px] font-black uppercase tracking-widest transition-all ${copiedId === a.wa ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-black hover:text-white'}`}>
                                 {copiedId === a.wa ? 'Copied' : 'Copy Promo Link'}
                               </button>
                               <button onClick={() => setAgents(agents.filter(x => x.wa !== a.wa))} className="p-3 bg-red-50 text-red-400 rounded-full hover:bg-red-500 hover:text-white transition-all"><Icon name="trash-2" size={16}/></button>
                             </div>
                           </div>
                         ))}
                       </div>
                    </div>
                  )}

                  {activeTab === 'templates' && (
                    <div className="bg-gray-50 p-12 rounded-[50px] space-y-8">
                       <h3 className="text-2xl font-black uppercase tracking-tighter">Promotions</h3>
                       <div className="grid md:grid-cols-4 gap-4">
                          <input id="tname" placeholder="Campaign Name" />
                          <input id="tdisc" placeholder="Discount RM" />
                          <input id="tend" type="date" />
                          <button onClick={() => {
                            const n = document.getElementById('tname').value;
                            const d = document.getElementById('tdisc').value;
                            const e = document.getElementById('tend').value;
                            if(!n || !d) return;
                            setTemplates([...templates, { id: Date.now(), name: n, discount: d, end: e }]);
                          }} className="bg-black text-white rounded-2xl font-black uppercase text-[9px] tracking-widest">Save Promo</button>
                       </div>
                       <div className="space-y-4">
                         {templates.map(t => (
                           <div key={t.id} className="bg-white p-6 rounded-3xl flex justify-between items-center shadow-sm">
                             <div><span className="font-black uppercase">{t.name}</span> <span className="text-lg-red ml-4">-RM{t.discount}</span></div>
                             <button onClick={() => setTemplates(templates.filter(x => x.id !== t.id))} className="text-red-400"><Icon name="x-circle" size={18}/></button>
                           </div>
                         ))}
                       </div>
                    </div>
                  )}

                  {activeTab === 'backup' && (
                    <div className="bg-lg-pearl p-20 rounded-[60px] text-center space-y-8">
                       <h2 className="text-3xl font-black uppercase tracking-tighter">System Backup & Recovery</h2>
                       <p className="text-gray-400 font-medium max-w-md mx-auto">导出的 JSON 文件包含所有产品、代理及站点配置。导入旧版本备份时，系统会自动尝试转换数据结构以保持兼容。</p>
                       <div className="flex justify-center gap-6 pt-10">
                          <button onClick={handleBackup} className="bg-black text-white px-12 py-5 rounded-full font-black uppercase text-[10px] tracking-widest shadow-xl hover:bg-lg-red transition-all">Export JSON</button>
                          <label className="bg-white text-lg-red border-2 border-lg-red px-12 py-5 rounded-full font-black uppercase text-[10px] tracking-widest shadow-xl cursor-pointer hover:bg-lg-red hover:text-white transition-all">
                            Import JSON
                            <input type="file" className="hidden" onChange={handleRestore} accept=".json" />
                          </label>
                       </div>
                    </div>
                  )}
               </div>
            </div>
          )}

          {/* Product Modal */}
          {editingProduct && (
            <div className="fixed inset-0 z-[100] flex items-center justify-center p-6">
              <div className="absolute inset-0 bg-lg-dark/60 backdrop-blur-md" onClick={() => setEditingProduct(null)}></div>
              <div className="bg-white w-full max-w-2xl rounded-[50px] p-10 relative z-10 shadow-3xl max-h-[90vh] overflow-y-auto space-y-6">
                <h3 className="text-2xl font-black uppercase tracking-tighter">Edit Product</h3>
                <div className="grid md:grid-cols-2 gap-6">
                   <div className="space-y-2">
                     <label className="text-[9px] font-black uppercase text-gray-300 ml-4">Name</label>
                     <input className="w-full" value={editingProduct.name} onChange={e => setEditingProduct({...editingProduct, name: e.target.value})} />
                   </div>
                   <div className="space-y-2">
                     <label className="text-[9px] font-black uppercase text-gray-300 ml-4">Price RM</label>
                     <input className="w-full" type="number" value={editingProduct.price} onChange={e => setEditingProduct({...editingProduct, price: e.target.value})} />
                   </div>
                   <div className="space-y-2 md:col-span-2">
                     <label className="text-[9px] font-black uppercase text-gray-300 ml-4">Image URL</label>
                     <input className="w-full" value={editingProduct.image} onChange={e => setEditingProduct({...editingProduct, image: e.target.value})} />
                   </div>
                   {['cn', 'en', 'ms'].map(l => (
                     <div key={l} className="space-y-2 md:col-span-2">
                       <label className="text-[9px] font-black uppercase text-gray-300 ml-4">Subtitle ({l.toUpperCase()})</label>
                       <input className="w-full" value={editingProduct.subName[l] || ""} onChange={e => {
                         const newSub = {...editingProduct.subName, [l]: e.target.value};
                         setEditingProduct({...editingProduct, subName: newSub});
                       }} />
                     </div>
                   ))}
                </div>
                <div className="flex gap-4 pt-6">
                  <button onClick={() => {
                    const updated = products.map(p => p.id === editingProduct.id ? editingProduct : p);
                    setProducts(updated);
                    setEditingProduct(null);
                  }} className="flex-grow bg-lg-red text-white py-5 rounded-full font-black uppercase text-[10px] tracking-widest shadow-xl">Update Product</button>
                  <button onClick={() => { if(confirm("Delete?")) { setProducts(products.filter(p => p.id !== editingProduct.id)); setEditingProduct(null); } }} className="px-8 bg-gray-100 text-red-500 rounded-full hover:bg-red-500 hover:text-white transition-all"><Icon name="trash-2" size={20}/></button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>